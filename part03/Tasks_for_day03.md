# Day 03 - Piscine SQL

## _Продолжая JOIN и вносить изменения в данные_

Резюме: Сегодня вы увидите, как изменять данные на основе языка DML

## Exercise 00 - Let’s find appropriate prices for Kate

| Exercise 00: Let’s find appropriate prices for Kate |                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| Turn-in directory                     | ex00                                                                                                                     |
| Files to turn-in                      | `day03_ex00.sql`                                                                                 |
| **Allowed**                               |                                                                                                                          |
| Language                        | ANSI SQL                                                                                              |

Пожалуйста, напишите SQL-запрос, который возвращает список названий пицц, цен на пиццу, названий пиццерий и дат посещения для Kate, а также цены в диапазоне от 800 до 1000 рублей. Пожалуйста, отсортируйте по названиям пиццы, цене и пиццерии. Взгляните на выборку данных, приведенную ниже.  


| pizza_name | price | pizzeria_name | visit_date |
| ------ | ------ | ------ | ------ |
| cheese pizza | 950 | DinoPizza | 2022-01-04 |
| pepperoni pizza | 800 | Best Pizza | 2022-01-03 |
| pepperoni pizza | 800 | DinoPizza | 2022-01-04 |
| ... | ... | ... | ... |


## Exercise 01 - Let’s find forgotten menus

| Exercise 01: Let’s find forgotten menus|                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| Turn-in directory                     | ex01                                                                                                                     |
| Files to turn-in                      | `day03_ex01.sql`                                                                                 |
| **Allowed**                               |                                                                                                                          |
| Language                        | ANSI SQL                                                                                              |
| **Denied**                               |                                                                                                                          |
| SQL Syntax Construction                        | any type of `JOINs`                                                                                              |

Пожалуйста, найдите все идентификаторы меню, которые никем не были заказаны. Результат должен быть отсортирован по идентификаторам. Пример выходных данных представлен ниже.

| menu_id |
| ------ |
| 5 |
| 10 |
| ... |


## Exercise 02 - Let’s find forgotten pizza and pizzerias

| Exercise 02: Let’s find forgotten pizza and pizzerias|                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| Turn-in directory                     | ex02                                                                                                                     |
| Files to turn-in                      | `day03_ex02.sql`                                                                                 |
| **Allowed**                               |                                                                                                                          |
| Language                        | ANSI SQL                                                                                              |

Пожалуйста, воспользуйтесь инструкцией SQL из упражнения №01 и выведите названия пиццерий, которые никто не заказывал, а также соответствующие цены. Результат должен быть отсортирован по названию пиццы и цене. Пример выходных данных представлен ниже.

| pizza_name | price | pizzeria_name |
| ------ | ------ | ------ |
| cheese pizza | 700 | Papa Johns |
| cheese pizza | 780 | DoDo Pizza |
| ... | ... | ... |

## Exercise 03 - Let’s compare visits

| Exercise 03: Let’s compare visits |                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| Turn-in directory                     | ex03                                                                                                                     |
| Files to turn-in                      | `day03_ex03.sql`                                                                                 |
| **Allowed**                               |                                                                                                                          |
| Language                        | ANSI SQL                                                                                              |

Пожалуйста, найдите пиццерии, которые чаще посещают женщины или мужчины. Для любых SQL-операторов с наборами сохраняйте дубликаты  (UNION ALL, EXCEPT ALL, INTERSECT ALL constructions). Пожалуйста, отсортируйте результат по названию пиццерии. Ниже приведен пример данных.


| pizzeria_name | 
| ------ | 
| Best Pizza | 
| Dominos |
| ... |

## Exercise 04 - Let’s compare orders


| Exercise 04: Let’s compare orders |                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| Turn-in directory                     | ex04                                                                                                                     |
| Files to turn-in                      | `day03_ex04.sql`                                                                                 |
| **Allowed**                               |                                                                                                                          |
| Language                        | ANSI SQL                                                                                              |

Пожалуйста, найдите объединение пиццерий, в которые поступают заказы как от женщин, так и от мужчин. Другими словами, вам следует найти набор названий пиццерий, заказанных только женщинами, и выполнить операцию "UNION" с набором названий пиццерий, заказанных только мужчинами. Пожалуйста, обратите внимание на слово “only” для обоих полов. Для любых SQL-операторов с sets не сохраняйте дубликаты (`UNION`, `EXCEPT`, `INTERSECT`).  Пожалуйста, отсортируйте результат по названию пиццерии. Пример данных приведен ниже.


| pizzeria_name | 
| ------ | 
| Papa Johns | 

## Exercise 05 - Visited but did not make any order


| Exercise 05: Visited but did not make any order |                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| Turn-in directory                     | ex05                                                                                                                     |
| Files to turn-in                      | `day03_ex05.sql`                                                                                 |
| **Allowed**                               |                                                                                                                          |
| Language                        | ANSI SQL                                                                                              |

Пожалуйста, напишите SQL-запрос, который возвращает список пиццерий, которые Андрей посещал, но не делал никаких заказов. Пожалуйста, сделайте заказ по названию пиццерии. Ниже приведен пример данных.


| pizzeria_name | 
| ------ | 
| Pizza Hut | 



## Exercise 06 - Find price-similarity pizzas


| Exercise 06: Find price-similarity pizzas |                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| Turn-in directory                     | ex06                                                                                                                     |
| Files to turn-in                      | `day03_ex06.sql`                                                                                 |
| **Allowed**                               |                                                                                                                          |
| Language                        | ANSI SQL                                                                                              |

Пожалуйста, найдите одинаковые названия пиццерий с одинаковой ценой, но из разных пиццерий. Убедитесь, что результат упорядочен по названию пиццы. Пример данных представлен ниже. Пожалуйста, убедитесь, что названия ваших столбцов соответствуют названиям столбцов ниже.

| pizza_name | pizzeria_name_1 | pizzeria_name_2 | price |
| ------ | ------ | ------ | ------ |
| cheese pizza | Best Pizza | Papa Johns | 700 |
| ... | ... | ... | ... |

## Exercise 07 - Let’s cook a new type of pizza


| Exercise 07: Let’s cook a new type of pizza |                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| Turn-in directory                     | ex07                                                                                                                     |
| Files to turn-in                      | `day03_ex07.sql`                                                                                 |
| **Allowed**                               |                                                                                                                          |
| Language                        | ANSI SQL                                                                                              |

Пожалуйста, зарегистрируйте новую пиццу с названием “греческая пицца” (use id = 19) стоимостью 800 рублей в ресторане “Доминос” (pizzeria_id = 2).  
**Внимание**: возможно, это действие приведет к неправильному изменению данных. На самом деле, вы можете восстановить исходную модель базы данных, используя данные по ссылке в разделе “Правила дня”.


## Exercise 08 - Let’s cook a new type of pizza with more dynamics


| Exercise 08: Let’s cook a new type of pizza with more dynamics |                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| Turn-in directory                     | ex08                                                                                                                     |
| Files to turn-in                      | `day03_ex08.sql`                                                                                 |
| **Allowed**                               |                                                                                                                          |
| Language                        | ANSI SQL                                                                                              |           
| **Denied**                               |                                                                                                                          |
| SQL Syntax Pattern                        | Don’t use direct numbers for identifiers of Primary Key and pizzeria                                                                                               |       

Пожалуйста, зарегистрируйте новую пиццу с названием “сицилийская пицца” (идентификатор которой должен быть рассчитан по формуле “максимальное значение идентификатора + 1”) стоимостью 900 рублей в ресторане “Доминос” (пожалуйста, используйте внутренний запрос для получения идентификатора пиццерии).  
**Внимание**: это упражнение, вероятно, приведет к неправильному изменению данных. На самом деле, вы можете восстановить исходную модель базы данных, используя данные по ссылке в разделе “Правила дня” и воспроизвести сценарий из упражнения 07.


## Exercise 09 - New pizza means new visits


| Exercise 09: New pizza means new visits |                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| Turn-in directory                     | ex09                                                                                                                     |
| Files to turn-in                      | `day03_ex09.sql`                                                                                 |
| **Allowed**                               |                                                                                                                          |
| Language                        | ANSI SQL                                                                                              |
| **Denied**                               |                                                                                                                          |
| SQL Syntax Pattern                        | Don’t use direct numbers for identifiers of Primary Key and pizzeria                                                                                               |       

Пожалуйста, зарегистрируйте новые посещения Денисом и Ириной ресторана Dominos 24 февраля 2022 года.  
**Внимание**: это упражнение, вероятно, приведет к неправильному изменению данных. На самом деле, вы можете восстановить исходную модель базы данных с помощью данных по ссылке в разделе “Правила дня” и воспроизвести сценарий из упражнений 07 и 08..


## Exercise 10 - New visits means new orders


| Exercise 10: New visits means new orders |                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| Turn-in directory                     | ex10                                                                                                                     |
| Files to turn-in                      | `day03_ex10.sql`                                                                                 |
| **Allowed**                               |                                                                                                                          |
| Language                        | ANSI SQL                                                                                              |
| **Denied**                               |                                                                                                                          |
| SQL Syntax Pattern                        | Don’t use direct numbers for identifiers of Primary Key and pizzeria                                                                                               |     


Пожалуйста, зарегистрируйте новые заказы от Дениса и Ирины на 24 февраля 2022 года для нового меню с “sicilian pizza”.  
**Внимание**: это упражнение, вероятно, приведет к неправильному изменению данных. На самом деле, вы можете восстановить исходную модель базы данных с помощью данных по ссылке в разделе “Правила дня” и воспроизвести сценарий из упражнений 07, 08 и 09.


## Exercise 11 - “Improve” a price for clients


| Exercise 11: “Improve” a price for clients|                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| Turn-in directory                     | ex11                                                                                                                     |
| Files to turn-in                      | `day03_ex11.sql`                                                                                 |
| **Allowed**                               |                                                                                                                          |
| Language                        | ANSI SQL                                                                                              |
    
Пожалуйста, измените цену на “greek pizza” на -10% от текущей стоимости.  
**Внимание**: возможно, это действие приведет к неправильному изменению данных. На самом деле, вы можете восстановить исходную модель базы данных с помощью данных по ссылке в разделе “Правила дня” и воспроизвести сценарий из упражнений 07, 08,09 и 10.


## Exercise 12 - New orders are coming!


| Exercise 12: New orders are coming!|                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| Turn-in directory                     | ex12                                                                                                                     |
| Files to turn-in                      | `day03_ex12.sql`                                                                                 |
| **Allowed**                               |                                                                                                                          |
| Language                        | ANSI SQL                                                                                              |
| SQL Syntax Construction                        | `generate_series(...)`                                                                                              |
| SQL Syntax Patten                        | Please use “insert-select” pattern
`INSERT INTO ... SELECT ...`|
| **Denied**                               |                                                                                                                          |
| SQL Syntax Patten                        | - Don’t use direct numbers for identifiers of Primary Key, and menu 
- Don’t use window functions like `ROW_NUMBER( )`
- Don’t use atomic `INSERT` statements |

Пожалуйста, зарегистрируйте новые заказы от всех пользователей на `greek pizza` на 25 февраля 2022 года.  
**Внимание**: это действие, вероятно, приведет к неправильному изменению данных. На самом деле, вы можете восстановить исходную модель базы данных с помощью данных по ссылке в разделе “Правила дня” и воспроизвести сценарий из упражнений 07, 08,09, 10 и 11.


## Exercise 13 - Money back to our customers


| Exercise 13: Money back to our customers|                                                                                                                          |
|---------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| Turn-in directory                     | ex13                                                                                                                     |
| Files to turn-in                      | `day03_ex13.sql`                                                                                 |
| **Allowed**                               |                                                                                                                          |
| Language                        | ANSI SQL                                                                                              |
    
Пожалуйста, напишите 2 инструкции SQL (DML), которые удаляют все новые заказы из упражнения №12 на основе даты заказа. Затем удалите “греческую пиццу” из меню.  
**Внимание**: это упражнение, вероятно, приведет к неправильному изменению данных. На самом деле, вы можете восстановить исходную модель базы данных с помощью данных по ссылке в разделе “Правила дня” и воспроизвести сценарий из упражнений 07 , 08 ,09 , 10 , 11, 12 и 13.

[Вернуться в README.md](../README.md)